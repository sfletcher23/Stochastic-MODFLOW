function [y1] = myNeuralNetworkFunction4(x1, maxValue, minValue)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 14-May-2017 11:03:33.
%
% [y1] = myNeuralNetworkFunction(x1) takes these arguments:
%   x = Qx5 matrix, input #1
% and returns:
%   y = Qx2 matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.00126557826065345;0.00105005371411575;-49963.5589717891;-49798.4921107386;0.020642128];
x1_step1.gain = [2.00465920534037;223.654439347246;3.77642572091383e-05;3.79784222354717e-05;0.000333526269226396];
x1_step1.ymin = -1;

% Layer 1
b1 = [-0.11262700928413499346;-0.4138976643468124661;1.9483536203887565907;-5.0177824465420695077;-21.02906175914942466;2.4454431505283875659;-3.8360871816347694718;-1.9859579820139847683;36.089229058990575538;0.02862826210577840147;-3.0934449963347532275;-3.8762789026023352079;3.2717864494431374567;-40.584212711838610232;1.6912499445032604939;-21.756031028088308688;-16.204060094499304512;36.346508766054434147;52.055321079493516834;17.325458241451141106];
IW1_1 = [0.79711134706302733122 -0.10265498778151156689 0.11556235909904091774 1.578252345914956889 -0.45142015967155935119;-1.1484372274796434965 0.10145073147868505226 -1.6070688670235315776 0.0090125018509557459911 0.63940617235529062512;0.43331941124732331616 -0.056310962983179287111 1.5426491102148651713 -0.086145405123665169667 0.82192604703483918005;-0.19277337514367551274 0.12985585465738888611 2.2477551999796370197 2.52191656471668324 -0.33004940506187080418;-8.2169889124518640244 -0.74348847472620460675 -5.2585600113650610155 8.8274120386172310049 1.4571109177367898013;2.9405521773629925697 -0.011483331641152795186 0.62046026854995628419 0.69131180791517921058 -1.8620546280014154128;-5.7019340853544804304 0.057947705233709415062 -1.583066345551610965 -0.29359579028468013595 1.997374952709972673;-2.2259256202034727323 -0.026029325637762550094 -2.4711880518312860922 -7.3604863572519780845 9.2645237958026953606;31.731208797730783289 0.5200540421796523427 2.7967077616799831397 -10.550539473438291793 -0.58726899643938490492;0.029697004333115763208 -0.012495733178892774046 -1.1179642267221931995 -0.85131530557348122912 2.060727595727523731;-0.13323944904950135726 0.089467147898443330489 1.5585467930197374198 1.7498432459015971219 -0.22563635032169765404;-0.14064238523100625056 0.094614769483875399425 1.6426141076788758344 1.8434422779257533254 -0.24012949495413477008;5.2283823488191982776 -0.026112594553729565061 0.25499271863845796027 1.7350787440031163467 -1.9288140212276390084;-48.676224921517544431 0.81546382314128251778 -0.015877523104215973682 -6.0644454590667384863 4.690232138411690066;0.034223096459392178537 -0.0084101339967932609715 0.1629896074125386507 0.41595610598263788038 1.3897920315208360797;-20.159637416757821171 -0.23179631132328265553 -0.11509518066117417623 -0.40442568086082675283 -3.4010136822031400428;-13.121025658730289365 0.23486524678340411909 2.5395654432058694105 -0.60257954296302695951 0.90668084692380834788;-0.63732849874547325975 0.69211455678889222121 -17.012506071540759223 -21.029725397078077975 -0.65248896444719906018;33.175244298248763641 1.0914381926718152993 -21.468685442300692756 3.4755671377670700473 -2.2685670809803766268;14.314605353280843048 -0.22765059587423241982 -2.3648081533409239796 0.57571870865484975344 -0.90176931038545860009];

% Layer 2
b2 = [-10.015357082663301824;-8.3774434291496326921];
LW2_1 = [0.0012916703791489262017 -0.0071822884113791965466 -0.0088758271808960908372 14.848814430256046748 -0.0017171654927376511258 -0.026404166463875135967 -0.016080038935819638418 -0.00069565234011610113576 0.0031883122931838322502 -0.012491612858672037148 6.8141196702765176596 -31.374354284931637693 0.0021278429286844947714 -0.0031291979729214237753 -0.019344988046016361322 -0.0084646748756912019995 7.0403967109645009259 -1.7552374812665865189 -0.14561731726572549328 8.2742613294424973702;0.0051968691974131333775 -0.00074696981398616384227 -0.0033531422475256140829 14.845459389883902901 0.54450049667609734527 -0.022457945654756193699 -0.0014859175440562369212 -0.0029826934140913777434 -0.0048779233147288316927 -0.010345250906949671893 6.8120674318735714436 -31.367270397054596742 0.012558304832075964722 -0.0057340178262238810855 -0.02328775340884842171 -0.0093011187734273487876 0.03183515507921067661 -1.7568335652983133599 0.0028521868384815641725 0.034002901110335166657];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [4.78151988468168e-05;4.78289452551318e-05];
y1_step1.xoffset = [0;0];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,1); % samples

% Input 1
x1 = x1';
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = repmat(b2,1,Q) + LW2_1*a1;

% Output 1
y1 = mapminmax_reverse(a2,y1_step1);
y1 = y1';

% Truncate ends
indexHigh = y1 > maxValue;
y1(indexHigh) = maxValue;
indexLow = y1 < minValue;
y1(indexLow) = minValue;


end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
