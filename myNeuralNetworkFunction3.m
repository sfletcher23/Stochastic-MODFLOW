function [y1] = myNeuralNetworkFunction3(x1, maxValue, minValue)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 09-May-2017 17:32:37.
%
% [y1] = myNeuralNetworkFunction(x1) takes these arguments:
%   x = Qx5 matrix, input #1
% and returns:
%   y = Qx2 matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0.00126557826065345;0.00105005371411575;-49963.5589717891;-49798.4921107386;0.020642128];
x1_step1.gain = [2.00465920534037;223.654439347246;3.77642572091383e-05;3.79784222354717e-05;0.000333526269226396];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.0257679256635900966;-21.981577267948040344;-0.7916624562668852505;-1.2954465335992089159;0.63990213799068640377;-0.91112235839737598653;-0.045841601837556540666;-3.093197377129900616;0.728368840540592144;2.9487736001607558478;16.42606270916956035;2.9716807352949672349;-3.00707454474446223;0.76899276774763070108;0.93938261027049796414;-17.553921803932833967;17.228718285196006121;27.927914532524766855;-28.987203129595457085;-16.692398528115464984];
IW1_1 = [-0.25805226839860834209 0.031570539431169102051 -0.18786750988142641994 -0.40869171910383578217 0.59451453690871813862;-0.68400589865427052771 0.41630865080978451953 9.9346909782570094194 11.69598094485514217 -0.74745436155242062082;0.11848433607333445916 -0.017429802366669692321 0.17398186163605147692 0.36752741150332463027 -0.28905665255567941641;-0.60762996309401229311 0.059093397263854270662 0.20989933013336503631 0.30585747623233311421 -1.707678103097674871;0.066516639588565615315 -0.0014290761693540570808 -0.34731510478168847733 -0.40344840811713467144 -0.018366039773165598187;0.19176042734423837111 -0.025074089410907614284 0.17908602432120174219 0.39982350025017698858 -0.44008161239852938706;-0.19919758409539201072 0.0083596579526411304156 -0.801173717046938072 -0.68954635663074193008 1.6226496360696620602;-4.5326771739073956624 -0.0029053901459836113663 -0.27648213064978582887 -0.4145505982764913222 1.0298134966862646511;0.004798862910710259902 -0.0070328832793677357321 0.4664324882876685896 0.65957171903172595595 -0.1491854532007220735;4.2128846794077450255 0.0044966197773759330331 0.24792546995087566541 0.44034830303964311859 -1.1250757379037401584;13.052797673463592432 0.38115748849793867903 -3.3975495624805236439 0.81587685154341627047 -1.1629601224006973492;4.2418560976262211781 0.004605484227700178991 0.21193290395641004031 0.48412013265174280718 -1.1410249447599740691;-4.351865067253038788 -0.0035806060494764078463 -0.2741407751648972102 -0.41206676206932713047 1.0709850989087972284;0.051517782931698286042 0.005105721921460271498 -0.47660849752068168428 -0.61924581227683250795 0.071738647863880483646;0.057130643159008009935 0.015068786222547361428 -0.69772331055453606918 -0.91205916590852442738 0.139537093660174083;-11.908858088170402922 0.30160040732470849711 -1.7921102266767932054 5.1499169197716065938 0.9261105852948189332;14.150156466020579415 0.5353285276651743585 -2.9787599659698549281 0.73133728196508307473 -1.1494794467399434001;0.18599181624979627125 -0.034662193034995181229 -13.487101006667334246 -15.39139435179875548 -0.52436727134088223501;-17.369946194965187658 5.6537219032119301332 4.8788980985248029398 -5.1912416857179621843 1.3181240340865547633;-11.214517562019379326 0.28426539474841716615 -1.6832568803997018936 4.8558542094788865739 0.87823535278617104183];

% Layer 2
b2 = [0.14234688377990464825;1.5300807815291181946];
LW2_1 = [-1.3530183418423513686 -1.1082947964338163427 3.723673892277971742 0.0099565468467894338578 -2.0487238542574086608 -3.9166858148349241731 -0.030169719050102891678 1.9540316559033048538 -0.30243699031681020584 -3.6273242072461826524 -3.43330851192643971 1.3701103692847842463 -4.2110580377274455799 2.5251622866014309388 -0.52259265262878606961 0.069539209530288276229 3.4596316674369602673 -2.102448567503508059 -0.6162212450227388949 -0.072486376994693707543;-1.9483594067356864166 -1.1097685516282889129 5.0007908815472621455 0.0086886059434914258981 -2.0479150245503388028 -5.5316726904745046056 -0.027878648939627451164 2.0506882421048588938 -0.3361881789047454494 -4.224758588069832399 0.011617487708574358168 1.8210236777540806941 -4.4508788196658439773 2.6314843091663830954 -0.53562834755904020767 -2.6517644135590172638 -0.010766331841529263452 -2.099551157168915605 -0.0067392788085278579682 3.3058371351701221208];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [4.78151988468168e-05;4.78289452551318e-05];
y1_step1.xoffset = [0;0];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,1); % samples

% Input 1
x1 = x1';
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = repmat(b2,1,Q) + LW2_1*a1;

% Output 1
y1 = mapminmax_reverse(a2,y1_step1);
y1 = y1';

% Truncate ends
indexHigh = y1 > maxValue;
y1(indexHigh) = maxValue;
indexLow = y1 < minValue;
y1(indexLow) = minValue;


end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
